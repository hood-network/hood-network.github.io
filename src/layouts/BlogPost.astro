---
import { type CollectionEntry, getEntries } from "astro:content";

import BlogBase from "@layouts/BlogBase.astro";

import Author from "@components/Author.astro";

type Props = CollectionEntry<"blog">;

const {
    id,
    data: { title, description, authors },
} = Astro.props;

const authorEntries = await getEntries(authors);
const authorList = authorEntries.map(a => a.data);
---

<BlogBase
    title={title}
    description={description}
    fragments={[
        {
            path: "/blog",
            content: "blog",
        },
        {
            path: `/blog/${id}`,
            content: id,
        },
    ]}
>
    <main>
        <div class="pre-content">
            <h1>{title}</h1>
            <span
                >written by {
                    authorList.map(author => {
                        return <Author {...author} />;
                    })
                }
            </span>
        </div>

        <article>
            <slot />
        </article>
    </main>
</BlogBase>

<style>
    main {
        width: 100%;
        max-width: 900px;
    }

    .pre-content {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-bottom: 2em;
    }

    .pre-content h1 {
        margin: 0;
    }

    .pre-content span {
        display: flex;
        align-items: center;
        gap: 10px;
    }
</style>
<style is:global>
    article h1 {
        font-size: 2em;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 1em 0;
    }

    a[data-hn-wraps="heading"] {
        color: inherit;
        text-decoration: none;
    }

    hr {
        display: block;
        margin: 1em 0;
        border: 0;
        border-top: 1px solid var(--hn-sys-color-outline-variant);
        padding: 0;
        width: 100%;
        height: 1px;
    }

    ol,
    ul {
        padding-left: 2em;
    }

    ul.contains-task-list {
        padding-left: 1em;
        list-style-type: none;
    }

    li.task-list-item > input[type="checkbox"] {
        display: inline-block;
        vertical-align: middle;
        translate: 0 -2px;
        margin-right: 0.5em;
        border-radius: 2px;
        width: 1em;
        height: 1em;
    }

    img {
        max-width: 100%;
    }

    p {
        margin: 1em 0;
    }

    code[data-hn-code-type="inline"] {
        border: 1px solid var(--hn-sys-color-outline);
        border-radius: 0.5em;
        background-color: var(--hn-sys-color-accent);
        padding: 0.25em 0.5em;
        line-height: 2;
    }

    code[data-hn-code-type="block"] {
        display: block;
        position: relative;
        width: 100%;
    }

    code[data-hn-code-type="block"]::before {
        display: block;
        position: absolute;
        top: 0;
        right: 0;
        content: attr(data-hn-code-language);
    }

    pre {
        box-sizing: border-box;
        margin: 1em 0;
        border: 1px solid var(--hn-sys-color-outline);
        border-radius: 0.5em;
        background-color: var(--hn-sys-color-accent) !important;
        padding: 1em;
        width: 100%;
    }

    blockquote {
        border-left: 4px solid var(--hn-sys-color-on-background);
        padding-left: 1em;
    }

    div[data-hn-wraps="table"] {
        margin: 1em 0;
        border: 1px solid var(--hn-sys-color-outline);
        border-radius: 0.5em;
        width: 100%;
        min-width: 100%;
        overflow-x: auto;
        scrollbar-width: thin;
    }

    table {
        border-collapse: collapse;
        width: 100%;
        min-width: fit-content;
    }

    table thead {
        background-color: var(--hn-sys-color-surface-variant);
    }

    table thead > tr:first-child {
        border: none;
    }

    table tr {
        border-top: 1px solid var(--hn-sys-color-outline);
    }

    table th:first-child,
    table td:first-child {
        border: none;
    }

    table th,
    table td {
        border-left: 1px solid var(--hn-sys-color-outline);
        padding: 1em;
    }
</style>
